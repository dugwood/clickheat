/** Code by www.dugwood.com */function addEvtListener(e,t,c){document.addEventListener?e?e.addEventListener(t,c,!1):addEventListener(t,c,!1):attachEvent&&(e?e.attachEvent("on"+t,c):attachEvent("on"+t,c))}var clickHeatGroup="",clickHeatSite="",clickHeatServer="",clickHeatLastIframe=-1,clickHeatTime=0,clickHeatQuota=-1,clickHeatBrowser="",clickHeatDocument="",clickHeatWait=500,clickHeatLocalWait=0,clickHeatDebug=-1!==document.location.href.indexOf("debugclickheat");function showClickHeatDebug(e){!0===clickHeatDebug&&(document.getElementById("clickHeatDebuggerSpan").innerHTML=e,document.getElementById("clickHeatDebuggerDiv").style.display="block")}function catchClickHeat(e){var t,c,i,a,r,o,l,n,s,u,k=!1,H=!1;try{if(showClickHeatDebug("Gathering click data..."),0===clickHeatQuota)return showClickHeatDebug("Click not logged: quota reached"),!0;if(""===clickHeatGroup)return showClickHeatDebug("Click not logged: group name empty (clickHeatGroup)"),!0;if(e=e||window.event,t=e.which||e.button,u=e.srcElement||null,0===t)return showClickHeatDebug("Click not logged: no button pressed"),!0;if(null!==u&&"iframe"===u.tagName.toLowerCase()){if(u.sourceIndex===clickHeatLastIframe)return showClickHeatDebug("Click not logged: same iframe (a click on iframe opens a popup and popup is closed => iframe gets the focus again)"),!0;clickHeatLastIframe=u.sourceIndex}else clickHeatLastIframe=-1;if(c=e.clientX,i=e.clientY,a=clickHeatDocument.clientWidth||window.innerWidth,u=clickHeatDocument.clientHeight||window.innerHeight,l=window.pageXOffset||clickHeatDocument.scrollLeft,n=window.pageYOffset||clickHeatDocument.scrollTop,r=Math.max(clickHeatDocument.scrollWidth,clickHeatDocument.offsetWidth,a),o=Math.max(clickHeatDocument.scrollHeight,clickHeatDocument.offsetHeight,u),a<c||u<i)return showClickHeatDebug("Click not logged: out of document (should be a click on scrollbars)"),!0;if(i+=n,(c+=l)<0||i<0||r<c||o<i)return showClickHeatDebug("Click not logged: out of document (should be a click out of the document's body)"),!0;if((u=new Date).getTime()-clickHeatTime<1e3)return showClickHeatDebug("Click not logged: at least 1 second between clicks"),!0;if(clickHeatTime=u.getTime(),0<clickHeatQuota&&--clickHeatQuota,u="s="+clickHeatSite+"&g="+clickHeatGroup+"&x="+c+"&y="+i+"&w="+a+"&b="+clickHeatBrowser+"&c="+t+"&random="+Date(),showClickHeatDebug("Ready to send click data..."),0!==clickHeatServer.indexOf("http")){try{H=new ActiveXObject("Msxml2.XMLHTTP")}catch(e){try{H=new ActiveXObject("Microsoft.XMLHTTP")}catch(e){H=null}}H||"undefined"==typeof XMLHttpRequest||(H=new XMLHttpRequest),H&&(!0===clickHeatDebug&&(H.onreadystatechange=function(){4===H.readyState&&(200===H.status?showClickHeatDebug("Click recorded at "+clickHeatServer+" with the following parameters:<br/>x = "+c+" ("+(c-l)+"px from left + "+l+"px of horizontal scrolling, max width = "+r+")<br/>y = "+i+" ("+(i-n)+"px from top + "+n+"px of vertical scrolling, max height = "+o+")<br/>width = "+a+"<br/>browser = "+clickHeatBrowser+"<br/>click = "+t+"<br/>site = "+clickHeatSite+"<br/>group = "+clickHeatGroup+"<br/><br/>Server answer: "+H.responseText):404===H.status?showClickHeatDebug("click.php was not found at: "+(""!==clickHeatServer?clickHeatServer:"/clickheat/click.php")+" please set clickHeatServer value"):showClickHeatDebug("click.php returned a status code "+H.status+" with the following error: "+H.responseText),clickHeatLocalWait=0)}),H.open("GET",clickHeatServer+"?"+u,!0),H.send(null),k=!0)}for(!1===k&&(!0===clickHeatDebug?showClickHeatDebug("Click recorded at "+clickHeatServer+" with the following parameters:<br/>x = "+(c+l)+" ("+c+"px from left + "+l+"px of horizontal scrolling)<br/>y = "+(i+n)+" ("+i+"px from top + "+n+"px of vertical scrolling)<br/>width = "+a+"<br/>browser = "+clickHeatBrowser+"<br/>click = "+t+"<br/>site = "+clickHeatSite+"<br/>group = "+clickHeatGroup+'<br/><br/>Server answer:<br/><iframe src="'+clickHeatServer+"?"+u+'" width="700" height="60"></iframe>'):(new Image).src=clickHeatServer+"?"+u),s=new Date,clickHeatLocalWait=s.getTime()+clickHeatWait;clickHeatLocalWait>s.getTime();)s=new Date}catch(e){showClickHeatDebug("An error occurred while processing click (Javascript error): "+e.message)}return!0}function initClickHeat(){var e,t,c,i,a;if(!0===clickHeatDebug&&((a=document.createElement("div")).id="clickHeatDebuggerDiv",a.style.padding="5px",a.style.display="none",a.style.position="absolute",a.style.top="200px",a.style.left="200px",a.style.border="1px solid #888",a.style.backgroundColor="#eee",a.style.color="#a00",a.style.zIndex=99,a.innerHTML='<a href="#" onmouseover="document.getElementById(\'clickHeatDebuggerDiv\').style.display = \'none\'; return false" style="float:right">Rollover to close</a><strong>ClickHeat debug:</strong><br/><br/><span id="clickHeatDebuggerSpan"></span>',document.body.appendChild(a)),""===clickHeatGroup||""===clickHeatServer)return showClickHeatDebug("ClickHeat NOT initialised: either clickHeatGroup or clickHeatServer is empty"),!1;for(a=document.location.protocol+"//"+document.location.host,0===clickHeatServer.indexOf(a)&&(clickHeatServer=clickHeatServer.substring(a.length,clickHeatServer.length)),addEvtListener(document,"mousedown",catchClickHeat),t=document.getElementsByTagName("iframe"),e=0;e<t.length;e+=1)addEvtListener(t[e],"focus",catchClickHeat);for(clickHeatDocument=document.documentElement&&0!==document.documentElement.clientHeight?document.documentElement:document.body,c=navigator.userAgent?navigator.userAgent.toLowerCase().replace(/-/g,""):"",i=["chrome","firefox","safari","msie","opera"],clickHeatBrowser="unknown",e=0;e<i.length;e+=1)if(-1!==c.indexOf(i[e])){clickHeatBrowser=i[e];break}showClickHeatDebug("ClickHeat initialised with:<br/>site = "+clickHeatSite+"<br/>group = "+clickHeatGroup+"<br/>server = "+clickHeatServer+"<br/>quota = "+(-1===clickHeatQuota?"unlimited":clickHeatQuota)+"<br/>browser = "+clickHeatBrowser+"<br/><br/><strong>Click in a blank area (not on a link) to test ClickHeat</strong>")}